<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <script>

        const wrapper = document.createElement('div');
        wrapper.className = "container";

        const leftDiv = document.createElement('div');
        leftDiv.className = "box1";

        const rightDiv = document.createElement('div');
        rightDiv.className = "box2";

        const image = document.createElement('img');
        image.className = "image";
        image.setAttribute("src", "images/targetRight.jpg");
        image.setAttribute("alt", "blue dot image");

        const form = document.createElement("form");
        form.setAttribute("onsubmit", "validateForm()");
        form.setAttribute("method", "post");
        form.setAttribute("name", "loginForm");
        form.className = "form";

        const heading = document.createElement("h2");
        heading.textContent = "Login";

        const emailLabel = document.createElement("label");
        emailLabel.textContent = "Email";
        emailLabel.setAttribute("for", "email");
        emailLabel.className = "label";

        const emailError = document.createElement("div");
        emailError.className = "error";
        emailError.id = "emailError";

        const emailInput = document.createElement("input");
        emailInput.setAttribute("placeholder", "Enter your email");
        emailInput.setAttribute("name", "email");
        emailInput.className = "inp";
        emailInput.id = "emailInput";

        const passwordLabel = document.createElement("label");
        passwordLabel.textContent = "Password";
        passwordLabel.setAttribute("for", "password");
        passwordLabel.className = "label";

        const passwordError = document.createElement("div");
        passwordError.className = "error";
        passwordError.id = "passwordError";

        const passwordInput = document.createElement("input");
        passwordInput.setAttribute("type", "password");
        passwordInput.setAttribute("placeholder", "Enter your password");
        passwordInput.setAttribute("name", "password");
        passwordInput.className = "inp";
        passwordInput.id = "passInput";

        const checkboxInput = document.createElement("input");
        checkboxInput.setAttribute("type", "checkbox");
        checkboxInput.setAttribute("name", "remember");

        const checkboxLabel = document.createElement("label");
        checkboxLabel.setAttribute("for", "remember");
        checkboxLabel.textContent = "Remember for 30 days";

        const forgotPasswordLink = document.createElement("a");
        forgotPasswordLink.setAttribute("href", "#");
        forgotPasswordLink.setAttribute("onclick", "forgotPass()");
        forgotPasswordLink.textContent = "Forgot password";
        forgotPasswordLink.className = "forgotPasswordLink";

        const finalError = document.createElement("div");
        finalError.className = "error";
        finalError.id = "finalError";

        const signInButton = document.createElement("input");
        signInButton.setAttribute("id", "signin");
        signInButton.setAttribute("type", "submit");
        signInButton.setAttribute("value", "Sign in");
        signInButton.className = "inpbut";

        const googleButton = document.createElement("button");
        googleButton.setAttribute("class", "inpbut");
        googleButton.textContent = "Sign in with Google";

        const signUpParagraph = document.createElement("p");
        signUpParagraph.textContent = "Don't have an account?";
        signUpParagraph.className = "signUpPara";

        const signUpLink = document.createElement("a");
        signUpLink.setAttribute("href", "#");
        signUpLink.textContent = "Sign up";

        // forgot password
        const fpform = document.createElement("form");
        fpform.setAttribute("method", "post");
        fpform.setAttribute("name", "forgotPasswordForm");
        fpform.className = "fpform";

        const formHeading = document.createElement("h2");
        formHeading.textContent = "Update Password";

        const fpemailLabel = document.createElement("label");
        fpemailLabel.textContent = "Email";
        fpemailLabel.setAttribute("for", "fpemail");
        fpemailLabel.className = "fplabel";

        const fpemailError = document.createElement("div");
        fpemailError.className = "fperror";
        fpemailError.id = "fpemailError";

        const fpemailInput = document.createElement("input");
        fpemailInput.setAttribute("placeholder", "Enter your email");
        fpemailInput.setAttribute("name", "fpemail");
        fpemailInput.className = "fpinp";
        fpemailInput.id = "fpemailinput";

        const fppasswordLabel = document.createElement("label");
        fppasswordLabel.textContent = "Password";
        fppasswordLabel.setAttribute("for", "fppassword");
        fppasswordLabel.className = "fplabel";
        fppasswordLabel.id = "fppasswordlabel";

        const fppasswordError = document.createElement("div");
        fppasswordError.className = "fperror";
        fppasswordError.id = "fppasswordError";

        const fppasswordInput = document.createElement("input");
        fppasswordInput.setAttribute("type", "password");
        fppasswordInput.setAttribute("placeholder", "Enter your password");
        fppasswordInput.setAttribute("name", "fppassword");
        fppasswordInput.disabled = true;
        fppasswordInput.className = "fpinp";
        fppasswordInput.id = "fppassInput";

        const fpchangePassword = document.createElement("input");
        fpchangePassword.setAttribute("id", "fpsignin");
        fpchangePassword.setAttribute("type", "submit");
        fpchangePassword.setAttribute("value", "Change Password");
        fpchangePassword.setAttribute("onclick", "changePass()");
        fpchangePassword.className = "inpbut";
        // ---------------

        document.body.appendChild(wrapper);

        wrapper.appendChild(leftDiv);
        wrapper.appendChild(rightDiv);

        leftDiv.appendChild(form);
        leftDiv.appendChild(fpform);
        rightDiv.appendChild(image);

        form.appendChild(heading);
        form.appendChild(emailLabel);
        form.appendChild(emailError);
        form.appendChild(emailInput);
        form.appendChild(passwordLabel);
        form.appendChild(passwordError);
        form.appendChild(passwordInput);
        form.appendChild(checkboxInput);
        form.appendChild(checkboxLabel);
        form.appendChild(forgotPasswordLink);
        form.appendChild(finalError);
        form.appendChild(signInButton);
        form.appendChild(googleButton);
        signUpParagraph.appendChild(signUpLink);
        form.appendChild(signUpParagraph);

        fpform.appendChild(formHeading);
        fpform.appendChild(fpemailLabel);
        fpform.appendChild(fpemailError);
        fpform.appendChild(fpemailInput);
        fpform.appendChild(fppasswordLabel);
        fpform.appendChild(fppasswordError);
        fpform.appendChild(fppasswordInput);
        fpform.appendChild(fpchangePassword);

        let storedEmailAndPass = [
            {
                "email": "david@gmail.com",
                "password": "David@123"
            },
            {
                "email": "mesh@gmail.com",
                "password": "Mesh@123"
            }
        ]


        function validateForm() {
            let email = document.forms["loginForm"]["email"].value;
            let password = document.forms["loginForm"]["password"].value;

            const regEmail = /^[a-zA-Z0-9.%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            const regPass = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=.\-_*])([a-zA-Z0-9@#$%^&+=*.\-_]){8,}$/;

            if (email.trim() == "" && password.trim() == "") {

                document.getElementById("emailError").innerHTML = "email must be filled out";

                document.getElementById("passwordError").innerHTML = "Password cannot be empty";

                disappear();

            }

            if (email.trim() == "" && password.trim() != "") {
                document.getElementById("emailError").innerHTML = "email must be filled out";

                if (!regPass.test(password)) {
                    document.getElementById("passwordError").innerHTML = "password format wrong";
                }

                disappear();

            }

            if (email.trim() != "" && password.trim() == "") {
                document.getElementById("passwordError").innerHTML = "Password cannot be empty";

                if (!regEmail.test(email)) {
                    document.getElementById("emailError").innerHTML = "email format wrong";
                }

                disappear();

            }

            if (email.trim() != "" && password.trim() != "") {

                if (!regEmail.test(email) && !regPass.test(password)) {
                    document.getElementById("emailError").innerHTML = "email format wrong";

                    document.getElementById("passwordError").innerHTML = "password format wrong";
                }
                else {
                    if (regEmail.test(email) && !regPass.test(password)) {
                        document.getElementById("passwordError").innerHTML = "password format wrong";
                    }
                    else {
                        if (!regEmail.test(email) && regPass.test(password)) {
                            document.getElementById("emailError").innerHTML = "email format wrong";
                        }
                    }
                }

                disappear();

            }

            if (email.trim() != "" && password.trim() != "" && regEmail.test(email) && regPass.test(password)) {

                let length = storedEmailAndPass.length;
                let detailsFound = false;
                let a = 0;

                for (let i = 0; i < length; i++) {
                    if (email == storedEmailAndPass[i].email && password == storedEmailAndPass[i].password) {
                        detailsFound = true;
                        break;
                    }
                    else if ( (email == storedEmailAndPass[i].email && password != storedEmailAndPass[i].password) || (email != storedEmailAndPass[i].email && password == storedEmailAndPass[i].password) ) {
                        detailsFound = false;
                        break;
                    }
                    else {
                        a++;
                    }

                }
                if (detailsFound == true) {
                    document.getElementById("finalError").innerHTML = "Loged In Successfully!!";
                    document.getElementById("finalError").style.color = "green";
                    document.getElementById("finalError").style.textAlign = "center";

                    disappear();
                }
                else if (detailsFound == false && a != length) {
                    document.getElementById("finalError").innerHTML = "Give the correct credentials!!";
                    document.getElementById("finalError").style.color = "red";
                    document.getElementById("finalError").style.textAlign = "center";

                    disappear();
                }
                else {
                    document.getElementById("finalError").innerHTML = "Your details is not found!! Try Signing Up!!";
                    document.getElementById("finalError").style.color = "red";
                    document.getElementById("finalError").style.textAlign = "center";

                    disappear();
                }

            }

        }
        document.querySelector('form').addEventListener('submit', function (event) {
            event.preventDefault();
            validateForm();
        });

        function disappear() {
            let emailField = document.getElementById("emailInput");

            emailField.addEventListener("input", function () {
                document.getElementById("emailError").innerHTML = "";

            })

            let passField = document.getElementById("passInput");

            passField.addEventListener("input", function () {
                document.getElementById("passwordError").innerHTML = "";
            })
        }

        function forgotPass() {
            document.querySelector("form").style.display = "none";
            document.getElementsByClassName("fpform")[0].style.display = "block";

            let fpemailValue;

            let fpemailField = document.getElementById("fpemailinput");

            fpemailField.addEventListener("input", function (event) {
                fpemailValue = document.getElementById("fpemailinput").value;
                validatefp();
            });

            function validatefp() {
                let length = storedEmailAndPass.length;
                let detailsFound = false;

                for (let i = 0; i < length; i++) {
                    if (fpemailValue == storedEmailAndPass[i].email) {
                        detailsFound = true;
                        break;
                    }

                }

                if (detailsFound) {
                    document.getElementById("fpemailError").innerHTML = "";
                    document.getElementById("fppasswordlabel").textContent = "Enter your new password";

                    document.getElementById("fppassInput").disabled = false;
                }
                else {
                    document.getElementById("fpemailError").innerHTML = "Your credentials does not exist in the database";
                    document.getElementById("fpemailError").style.color = "red";
                }
            }
        }

        function changePass() {
            fpemailValue = document.getElementById("fpemailinput").value;

            fppassValue = document.getElementById("fppassInput").value;

            let length = storedEmailAndPass.length;
            for (let i = 0; i < length; i++) {
                if (storedEmailAndPass[i].email == fpemailValue) {
                    storedEmailAndPass[i].password = fppassValue;
                    break;
                }
            }

            document.getElementsByClassName("fpform")[0].style.display = "none";
            document.getElementsByClassName("form")[0].style.display = "block";
        }

        document.querySelector('.fpform').addEventListener('submit', function (event) {
            event.preventDefault();
        });

    </script>


</body>

</html>